model:

sets:
nodes/0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29/:index;
links(nodes,nodes)/
0 16, 0 26, 0 9, 0 8, 0 7, 
0 6, 0 1, 0 2, 0 3, 1 19, 
1 18, 1 16, 1 15, 1 2, 1 3, 
2 4, 2 25, 2 21, 2 20, 2 3, 
3 19, 3 24, 3 27, 4 5, 4 6, 
5 6, 8 21, 9 10, 9 11, 10 26, 
10 11, 12 13, 12 14, 12 15, 13 14, 
13 15, 14 15, 17 18, 21 22, 21 23, 
21 24, 22 23, 22 24, 23 24, 26 27, 

16 0, 26 0, 9 0, 8 0, 7 0, 
6 0, 1 0, 2 0, 3 0, 19 1, 
18 1, 16 1, 15 1, 2 1, 3 1, 
4 2, 25 2, 21 2, 20 2, 3 2, 
19 3, 24 3, 27 3, 5 4, 6 4, 
6 5, 21 8, 10 9, 11 9, 26 10, 
11 10, 13 12, 14 12, 15 12, 14 13, 
15 13, 15 14, 18 17, 22 21, 23 21, 
24 21, 23 22, 24 22, 24 23, 27 26,

28 0,28 1,28 2,28 3,28 4,28 5,
28 6,28 7,28 8,28 9,28 10,
28 11,28 12,28 13,28 14,28 15,
28 16,28 17,28 18,28 19,28 20,
28 21,28 22,28 23,28 24,28 25,
28 26,28 27,
8 29,11 29,22 29,3 29,17 29,19 29,16 29,13 29,5 29,25 29,7 29,24 29/:cap,rent,flow,hasFlow;
endsets

data:
index=0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29;

cap=8 13 14 36 25 
13 20 16 13 26 
31 24 16 4 11 
37 24 5 2 7 
24 17 26 26 12 
14 36 6 14 11 
9 15 9 12 11 
27 19 22 22 18 
14 23 11 23 19 

8 13 14 36 25 
13 20 16 13 26 
31 24 16 4 11 
37 24 5 2 7 
24 17 26 26 12 
14 36 6 14 11 
9 15 9 12 11 
27 19 22 22 18 
14 23 11 23 19 

257 257 257 257 257 
257 257 257 257 257 
257 257 257 257 257 
257 257 257 257 257 
257 257 257 257 257 
257 257 257 
40 13 28 45 11 
26 15 13 18 15 
10 23;

rent=2 2 2 2 2 
2 1 1 1 2 
2 2 2 1 1 
2 2 2 2 1 
2 2 2 1 1 
1 5 1 1 5 
1 1 1 1 1 
1 1 1 1 1 
1 1 1 1 1 

2 2 2 2 2 
2 1 1 1 2 
2 2 2 1 1 
2 2 2 2 1 
2 2 2 1 1 
1 5 1 1 5 
1 1 1 1 1 
1 1 1 1 1 
1 1 1 1 1 

0 0 0 0 0 
0 0 0 0 0 
0 0 0 0 0 
0 0 0 0 0 
0 0 0 0 0 
0 0 0  
0 0 0 0 0 
0 0 0 0 0 
0 0;

maxflow=257;
tri=1000000;
enddata

min=@sum(links:flow*rent)+@sum(links(i,j)|index(i) #eq# 28:hasFlow(i,j)*100);

@for(links(i,j):@bin(hasFlow(i,j)));
@for(links(i,j):hasFlow(i,j) * tri >= flow(i,j));
@for(links(i,j):hasFlow(i,j) <= flow(i,j));

@sum(links(i,j)|index(i) #eq# 28:flow(i,j))=maxflow;

@sum(links(i,j)|index(j) #eq# 29:flow(i,j))=maxflow;

@for(nodes(i)|index(i) #ne# 28 #and# index(i) #ne# 29:@sum(links(i,j):flow(i,j))=@sum(links(v,i):flow(v,i)));

@for(links(i,j):flow(i,j)<=cap(i,j));

@for(links(i,j):flow(i,j)>=0);


end

